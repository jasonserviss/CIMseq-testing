---
title: "Cost stability"
author: "Jason T. Serviss"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r, message = FALSE, warning = FALSE}
#PACKAGES
library(tidyverse)

##DATA
load("../data/costs.rda")
```


```{r, fig.align="center", fig.width=10, fig.height=8}
tests <- seq(50, 1000, 50)
p <- data %>%
  setNames(tests) %>%
  add_column(rep = 1:nrow(.), .before = 1) %>%
  gather(nrOfMultiplets, Cost, -rep) %>%
  mutate(nrOfMultiplets = as.numeric(nrOfMultiplets)) %>%
  ggplot() +
  geom_boxplot(aes(nrOfMultiplets, Cost, group = nrOfMultiplets)) +
  theme_bw() +
  labs(
    x = "Number of synthetic multiplets",
    caption = "50 replicates per number of synthetic multiplets"
  ) + 
  theme(plot.caption = element_text(hjust = 0)) +
  scale_x_continuous(breaks = tests, minor_breaks = tests)

p

ggsave(
  plot = p, filename = '../figures/figure1.pdf',
  device = cairo_pdf, height = 180,
  width = 240, units = "mm"
)
```

```{r}
sessionInfo()
```

